<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Expense Tracker</title>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

</head>
<body>
    <!-- Login Screen -->
    <div id="login-screen" class="login-screen">
        <div class="login-container">
            <div class="login-header">
                <div class="app-logo">üí∞</div>
                <h1 class="app-title">Expense Tracker</h1>
                <p class="app-subtitle">Manage your finances with ease</p>
            </div>
            
            <div class="login-methods">
                <button id="google-signin-btn" class="btn btn-primary btn-google">
                    <svg width="18" height="18" viewBox="0 0 24 24">
                        <path fill="white" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                        <path fill="white" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                        <path fill="white" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                        <path fill="white" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                    </svg>
                    Sign in with Google
                </button>
                
                <div class="divider">
                    <span>or</span>
                </div>
                
                <form id="email-signin-form" class="email-form">
                    <div class="form-group">
                        <input type="email" id="signin-email" class="form-control" placeholder="Email address" required>
                    </div>
                    <div class="form-group">
                        <input type="password" id="signin-password" class="form-control" placeholder="Password" required>
                    </div>
                    <button type="submit" class="btn btn-primary btn-full-width">
                        Sign In
                    </button>
                </form>
                
                <div class="signup-link">
                    Don't have an account? <a href="#" id="show-signup">Sign up</a>
                </div>
            </div>
            
            <div class="guest-mode">
                <button id="guest-mode-btn" class="btn btn-secondary btn-full-width">
                    Continue as Guest
                </button>
                <p class="guest-notice">
                    Guest mode uses local storage only - no cloud backup
                </p>
            </div>
        </div>
    </div>
    
    <!-- Sign Up Form (Hidden by default) -->
    <div id="signup-form" class="signup-form hidden">
        <form id="email-signup-form">
            <h3>Create Account</h3>
            <div class="form-group">
                <input type="email" id="signup-email" class="form-control" placeholder="Email address" required>
            </div>
            <div class="form-group">
                <input type="password" id="signup-password" class="form-control" placeholder="Password (min 6 characters)" required minlength="6">
            </div>
            <button type="submit" class="btn btn-primary btn-full-width">
                Create Account
            </button>
            <div class="signin-link">
                Already have an account? <a href="#" id="show-signin">Sign in</a>
            </div>
        </form>
    </div>
    
    <!-- Loading Screen -->
    <div id="loading-screen" class="loading-screen hidden">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <p id="loading-text">Loading your data...</p>
        </div>
    </div>
    
    <!-- Main App -->
    <div id="app" class="hidden">
        <!-- Header -->
        <header id="header">
            <div class="header-content">
                <h1 id="screen-title">Transactions</h1>
                <div class="header-right">
                    <div id="sync-indicator" class="sync-indicator" title="Sync status">
                        <svg id="sync-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M1 4v6h6"/>
                            <path d="M23 20v-6h-6"/>
                            <path d="M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"/>
                        </svg>
                        <span id="sync-text">Synced</span>
                    </div>
                    
                    <div class="user-profile" id="user-profile">
                        <div id="user-avatar" class="user-avatar-initials" onclick="toggleProfileDropdown()">
                            <span id="user-initials">GU</span>
                            <img id="user-photo" class="user-photo hidden" alt="User photo">
                        </div>
                        <div class="user-dropdown" id="user-dropdown">
                            <div class="user-info">
                                <div id="user-name" class="user-name">Guest User</div>
                                <div id="user-email" class="user-email">guest@local</div>
                            </div>
                            <div class="user-actions">
                                <button class="profile-btn" onclick="openSetNameModal()" id="set-name-btn">Set Name</button>
                                <button class="profile-btn logout-btn" onclick="signOut()" id="logout-btn">Logout</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="month-nav" class="month-nav">
                    <button id="prev-month" class="nav-btn">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="15,18 9,12 15,6"></polyline>
                        </svg>
                    </button>
                    <span id="current-month">October 2024</span>
                    <button id="next-month" class="nav-btn">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="9,18 15,12 9,6"></polyline>
                        </svg>
                    </button>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main id="main-content">
            <!-- Transactions Screen -->
            <div id="transactions-screen" class="screen active">
                <div id="monthly-summary" class="summary-cards">
                    <div class="summary-card income">
                        <div class="summary-label">Income</div>
                        <div class="summary-amount" id="monthly-income">‚Çπ0</div>
                    </div>
                    <div class="summary-card expense">
                        <div class="summary-label">Expenses</div>
                        <div class="summary-amount" id="monthly-expenses">‚Çπ0</div>
                    </div>
                    <div class="summary-card balance">
                        <div class="summary-label">Balance</div>
                        <div class="summary-amount" id="monthly-balance">‚Çπ0</div>
                    </div>
                </div>
                <div id="transactions-list" class="transactions-list">
                    <!-- Transactions will be loaded here -->
                </div>
                <div id="empty-state" class="empty-state hidden">
                    <div class="empty-icon">üí≥</div>
                    <h3>No transactions yet</h3>
                    <p>Start tracking your expenses by adding your first transaction</p>
                    <button class="btn btn-primary" onclick="openAddTransactionModal()">Add Transaction</button>
                </div>
            </div>

            <!-- Analytics Screen -->
            <div id="analytics-screen" class="screen">
                <div class="period-selector">
                    <button class="period-btn active" data-period="month">Month</button>
                    <button class="period-btn" data-period="year">Year</button>
                </div>
                <div class="analytics-summary">
                    <div class="summary-card income">
                        <div class="summary-label">Total Income</div>
                        <div class="summary-amount" id="analytics-income">‚Çπ0</div>
                    </div>
                    <div class="summary-card expense">
                        <div class="summary-label">Total Expenses</div>
                        <div class="summary-amount" id="analytics-expenses">‚Çπ0</div>
                    </div>
                    <div class="summary-card balance">
                        <div class="summary-label">Net Savings</div>
                        <div class="summary-amount" id="analytics-savings">‚Çπ0</div>
                    </div>
                    <div class="summary-card category">
                        <div class="summary-label">Top Category</div>
                        <div class="summary-amount" id="top-category">-</div>
                    </div>
                </div>
                <div class="charts-container">
                    <div class="chart-card">
                        <h3>Expense Categories</h3>
                        <div class="chart-container">
                            <canvas id="categoryChart"></canvas>
                        </div>
                    </div>
                    <div class="chart-card">
                        <h3>Income vs Expenses Trend</h3>
                        <div class="chart-container">
                            <canvas id="trendChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Accounts Screen -->
            <div id="accounts-screen" class="screen">
                <div class="financial-summary">
                    <div class="summary-row">
                        <div class="financial-card assets">
                            <div class="financial-icon">üìà</div>
                            <div class="financial-info">
                                <div class="financial-label">Total Assets</div>
                                <div class="financial-amount" id="total-assets">‚Çπ0</div>
                            </div>
                        </div>
                        <div class="financial-card liabilities">
                            <div class="financial-icon">üí≥</div>
                            <div class="financial-info">
                                <div class="financial-label">Total Liabilities</div>
                                <div class="financial-amount" id="total-liabilities">‚Çπ0</div>
                            </div>
                        </div>
                    </div>
                    <div class="net-worth-card">
                        <div class="financial-icon">üí∞</div>
                        <div class="financial-info">
                            <div class="financial-label">Net Worth</div>
                            <div class="financial-amount large" id="net-worth">‚Çπ0</div>
                        </div>
                    </div>
                </div>
                <div class="accounts-list" id="accounts-list">
                    <!-- Accounts will be loaded here -->
                </div>
                <button class="btn btn-primary add-account-btn" onclick="openAddAccountModal()">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="12" y1="5" x2="12" y2="19"></line>
                        <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                    Add Account
                </button>
            </div>

            <!-- Settings Screen -->
            <div id="settings-screen" class="screen">
                <div class="settings-section">
                    <h3>Categories</h3>
                    <div class="categories-container">
                        <div class="category-group">
                            <h4>Income Categories</h4>
                            <div id="income-categories-list" class="categories-list"></div>
                            <button class="btn btn-secondary" onclick="openAddCategoryModal('income')">Add Income Category</button>
                        </div>
                        <div class="category-group">
                            <h4>Expense Categories</h4>
                            <div id="expense-categories-list" class="categories-list"></div>
                            <button class="btn btn-secondary" onclick="openAddCategoryModal('expense')">Add Expense Category</button>
                        </div>
                    </div>
                </div>
                
                <div class="settings-section">
                    <h3>Account Types Management</h3>
                    <div class="account-types-container">
                        <div id="account-types-list" class="account-types-list"></div>
                        <button class="btn btn-secondary" onclick="openAddAccountTypeModal()">Add Account Type</button>
                    </div>
                </div>

                <div class="settings-section">
                    <h3>App Settings</h3>
                    <div class="setting-item">
                        <label for="currency-select">Currency</label>
                        <select id="currency-select" class="form-control">
                            <option value="‚Çπ">‚Çπ Indian Rupee</option>
                            <option value="$">$ US Dollar</option>
                            <option value="‚Ç¨">‚Ç¨ Euro</option>
                            <option value="¬£">¬£ British Pound</option>
                            <option value="¬•">¬• Japanese Yen</option>
                        </select>
                    </div>
                    <div class="setting-item">
                        <label for="theme-toggle">Theme</label>
                        <div class="theme-toggle">
                            <input type="checkbox" id="theme-toggle">
                            <label for="theme-toggle" class="toggle-label">
                                <span class="toggle-text">Dark Mode</span>
                            </label>
                        </div>
                    </div>
                </div>

                <div class="settings-section">
                    <h3>User Profiles</h3>
                    <div class="profiles-container">
                        <div id="profiles-list" class="profiles-list"></div>
                        <button class="btn btn-secondary" onclick="openAddProfileModal()">Add Profile</button>
                    </div>
                </div>

                <div class="settings-section">
                    <h3>Data Management</h3>
                    <div class="data-actions">
                        <button class="btn btn-secondary" onclick="exportData()">Export Data</button>
                        <button class="btn btn-secondary" onclick="importData()">Import Data</button>
                        <button class="btn btn-danger" onclick="clearAllData()">Clear All Data</button>
                    </div>
                </div>
            </div>
        </main>

        <!-- Floating Bottom Menu -->
        <nav id="floating-menu" class="floating-menu">
            <div class="menu-container">
                <button class="menu-item active" data-screen="transactions" style="pointer-events: auto;">
                    <div class="menu-icon">
                        <span class="menu-emoji">üè†</span>
                        <div class="active-dot"></div>
                    </div>
                    <span class="menu-label">Home</span>
                </button>
                <button class="menu-item" data-screen="analytics" style="pointer-events: auto;">
                    <div class="menu-icon">
                        <span class="menu-emoji">üìä</span>
                        <div class="active-dot"></div>
                    </div>
                    <span class="menu-label">Charts</span>
                </button>
                <button class="menu-item" data-screen="accounts" style="pointer-events: auto;">
                    <div class="menu-icon">
                        <span class="menu-emoji">üí∞</span>
                        <div class="active-dot"></div>
                    </div>
                    <span class="menu-label">Accounts</span>
                </button>
                <button class="menu-item" data-screen="settings" style="pointer-events: auto;">
                    <div class="menu-icon">
                        <span class="menu-emoji">‚öôÔ∏è</span>
                        <div class="active-dot"></div>
                    </div>
                    <span class="menu-label">Settings</span>
                </button>
            </div>
        </nav>

        <!-- Floating Action Button -->
        <button id="fab" class="fab" onclick="openAddTransactionModal()" style="pointer-events: auto; z-index: 999;">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="12" y1="5" x2="12" y2="19"></line>
                <line x1="5" y1="12" x2="19" y2="12"></line>
            </svg>
        </button>
    </div>

    <!-- Add Account Type Modal -->
    <div id="account-type-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="account-type-modal-title">Add Account Type</h3>
                <button class="close-btn" onclick="closeModal('account-type-modal')">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <form id="account-type-form">
                <div class="form-group">
                    <label for="account-type-name">Account Type Name</label>
                    <input type="text" id="account-type-name" class="form-control" required placeholder="e.g., Digital Wallet">
                </div>
                
                <div class="form-group">
                    <label for="account-type-icon">Icon/Emoji</label>
                    <div class="emoji-selector">
                        <input type="text" id="account-type-icon" class="form-control" placeholder="üì±" maxlength="2">
                        <div class="emoji-options">
                            <span onclick="selectEmoji('üè¶')">üè¶</span>
                            <span onclick="selectEmoji('üí≥')">üí≥</span>
                            <span onclick="selectEmoji('üíµ')">üíµ</span>
                            <span onclick="selectEmoji('üìà')">üìà</span>
                            <span onclick="selectEmoji('üì±')">üì±</span>
                            <span onclick="selectEmoji('üí∞')">üí∞</span>
                            <span onclick="selectEmoji('üè™')">üè™</span>
                            <span onclick="selectEmoji('‚ö°')">‚ö°</span>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="account-type-color">Color</label>
                    <input type="color" id="account-type-color" class="form-control color-picker" value="#8B4513">
                </div>
                
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('account-type-modal')">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Account Type</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Transaction Modal -->
    <div id="transaction-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="transaction-modal-title">Add Transaction</h3>
                <button class="close-btn" onclick="closeModal('transaction-modal')">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <form id="transaction-form">
                <div class="transaction-type-selector">
                    <button type="button" class="type-btn active" data-type="expense">Expense</button>
                    <button type="button" class="type-btn" data-type="income">Income</button>
                    <button type="button" class="type-btn" data-type="transfer">Transfer</button>
                </div>
                
                <div class="form-group">
                    <label for="transaction-amount">Amount</label>
                    <div class="amount-input">
                        <span class="currency-symbol">‚Çπ</span>
                        <input type="number" id="transaction-amount" class="form-control" required step="0.01" min="0.01">
                        <button type="button" class="recurring-icon" id="recurring-icon" onclick="toggleRecurringDropdown()" title="Set recurring frequency">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                                <path d="M1 4v6h6"/>
                                <path d="M23 20v-6h-6"/>
                                <path d="M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"/>
                            </svg>
                        </button>
                        <div class="recurring-dropdown" id="recurring-dropdown">
                            <div class="recurring-option" onclick="setRecurring('none')">‚ùå None</div>
                            <div class="recurring-option" onclick="setRecurring('daily')">üìÖ Daily</div>
                            <div class="recurring-option" onclick="setRecurring('weekly')">üìÜ Weekly</div>
                            <div class="recurring-option" onclick="setRecurring('monthly')">üóìÔ∏è Monthly</div>
                            <div class="recurring-option" onclick="setRecurring('yearly')">üìã Yearly</div>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="transaction-account">Account</label>
                    <select id="transaction-account" class="form-control" required>
                        <!-- Options will be loaded dynamically -->
                    </select>
                </div>
                
                <div class="form-group" id="to-account-group" style="display: none;">
                    <label for="transaction-to-account">To Account</label>
                    <select id="transaction-to-account" class="form-control">
                        <!-- Options will be loaded dynamically -->
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="transaction-category">Category</label>
                    <select id="transaction-category" class="form-control" required>
                        <!-- Options will be loaded dynamically -->
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="transaction-date">Date</label>
                    <input type="date" id="transaction-date" class="form-control" required>
                </div>
                
                <div class="form-group">
                    <label for="transaction-description">Description</label>
                    <input type="text" id="transaction-description" class="form-control" placeholder="Enter description">
                </div>
                
<input type="hidden" id="transaction-recurring" value="none">
                
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('transaction-modal')">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Transaction</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Account Modal -->
    <div id="account-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="account-modal-title">Add Account</h3>
                <button class="close-btn" onclick="closeModal('account-modal')">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <form id="account-form">
                <div class="form-group">
                    <label for="account-name">Account Name</label>
                    <input type="text" id="account-name" class="form-control" required placeholder="Enter account name">
                </div>
                
                <div class="form-group">
                    <label for="account-type">Account Type</label>
                    <select id="account-type" class="form-control" required>
                        <option value="Bank Account">Bank Account</option>
                        <option value="Credit Card">Credit Card</option>
                        <option value="Cash">Cash</option>
                        <option value="Investment">Investment</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="account-balance">Initial Balance</label>
                    <div class="amount-input">
                        <span class="currency-symbol">‚Çπ</span>
                        <input type="number" id="account-balance" class="form-control" required step="0.01">
                    </div>
                </div>
                
                <div class="form-group">
                    <div class="checkbox-group">
                        <input type="checkbox" id="account-include-total" checked>
                        <label for="account-include-total">Include in total balance</label>
                    </div>
                </div>
                
                <div id="credit-card-fields" style="display: none;">
                    <div class="form-group">
                        <label for="credit-limit">Credit Limit</label>
                        <div class="amount-input">
                            <span class="currency-symbol">‚Çπ</span>
                            <input type="number" id="credit-limit" class="form-control" step="0.01">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="billing-day">Billing Day</label>
                        <input type="number" id="billing-day" class="form-control" min="1" max="31">
                    </div>
                    <div class="form-group">
                        <label for="payment-day">Payment Day</label>
                        <input type="number" id="payment-day" class="form-control" min="1" max="31">
                    </div>
                </div>
                
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('account-modal')">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Account</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Category Modal -->
    <div id="category-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="category-modal-title">Add Category</h3>
                <button class="close-btn" onclick="closeModal('category-modal')">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <form id="category-form">
                <div class="form-group">
                    <label for="category-name">Category Name</label>
                    <input type="text" id="category-name" class="form-control" required placeholder="Enter category name">
                </div>
                
                <div class="form-group">
                    <label for="category-icon">Icon (Emoji)</label>
                    <input type="text" id="category-icon" class="form-control" placeholder="üçΩÔ∏è" maxlength="2">
                </div>
                
                <div class="form-group">
                    <label for="category-color">Color</label>
                    <input type="color" id="category-color" class="form-control color-picker">
                </div>
                
                <div id="budget-field" class="form-group" style="display: none;">
                    <label for="category-budget">Monthly Budget</label>
                    <div class="amount-input">
                        <span class="currency-symbol">‚Çπ</span>
                        <input type="number" id="category-budget" class="form-control" step="0.01" min="0">
                    </div>
                </div>
                
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('category-modal')">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Category</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Toast Container -->
    <div id="toast-container"></div>

    <!-- Confirmation Dialog -->
    <div id="confirm-dialog" class="modal">
        <div class="modal-content confirm-content">
            <h3 id="confirm-title">Confirm Action</h3>
            <p id="confirm-message">Are you sure you want to proceed?</p>
            <div class="modal-actions">
                <button class="btn btn-secondary" onclick="closeConfirmDialog()">Cancel</button>
                <button class="btn btn-danger" id="confirm-yes-btn" onclick="confirmAction()">Yes</button>
            </div>
        </div>
    </div>

    <!-- Set Name Modal -->
    <div id="set-name-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Set Your Name</h3>
                <button class="close-btn" onclick="closeModal('set-name-modal')">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <form id="set-name-form">
                <div class="form-group">
                    <label for="profile-name">Your Name</label>
                    <input type="text" id="profile-name" class="form-control" required placeholder="Enter your name">
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('set-name-modal')">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Profile Modal -->
    <div id="add-profile-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="profile-modal-title">Add Profile</h3>
                <button class="close-btn" onclick="closeModal('add-profile-modal')">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <form id="add-profile-form">
                <div class="form-group">
                    <label for="new-profile-name">Profile Name</label>
                    <input type="text" id="new-profile-name" class="form-control" required placeholder="e.g., Personal, Business">
                </div>
                <div class="form-group">
                    <label for="profile-color">Profile Color</label>
                    <div class="color-options">
                        <input type="radio" name="profileColor" value="#8B4513" id="color1" checked>
                        <label for="color1" style="background-color: #8B4513"></label>
                        <input type="radio" name="profileColor" value="#DC143C" id="color2">
                        <label for="color2" style="background-color: #DC143C"></label>
                        <input type="radio" name="profileColor" value="#1E88E5" id="color3">
                        <label for="color3" style="background-color: #1E88E5"></label>
                        <input type="radio" name="profileColor" value="#4CAF50" id="color4">
                        <label for="color4" style="background-color: #4CAF50"></label>
                        <input type="radio" name="profileColor" value="#9C27B0" id="color5">
                        <label for="color5" style="background-color: #9C27B0"></label>
                        <input type="radio" name="profileColor" value="#FF9800" id="color6">
                        <label for="color6" style="background-color: #FF9800"></label>
                    </div>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('add-profile-modal')">Cancel</button>
                    <button type="submit" class="btn btn-primary">Create Profile</button>
                </div>
            </form>
        </div>
    </div>

    <input type="file" id="import-file" accept=".json" style="display: none;" onchange="handleFileImport(event)">

    <!-- 
    FIREBASE SETUP INSTRUCTIONS:
    
    1. Go to https://console.firebase.google.com
    2. Create a new project or select existing one
    3. Enable Authentication:
       - Go to Authentication > Sign-in method
       - Enable Google and Email/Password providers
    4. Enable Firestore Database:
       - Go to Firestore Database > Create database
       - Start in test mode (update rules later)
    5. Get your config:
       - Go to Project settings > Your apps
       - Copy the firebaseConfig object
       - Replace the placeholder config in app.js
    6. Deploy Firestore Security Rules:
       rules_version = '2';
       service cloud.firestore {
         match /databases/{database}/documents {
           match /users/{userId}/{document=**} {
             allow read, write: if request.auth != null && request.auth.uid == userId;
           }
         }
       }
    -->
    
    <!-- Firebase SDK v9 Modular -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js"></script>
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        // Debug function to test if JavaScript is working
        function testClick() {
            console.log('Test click working!');
            alert('JavaScript is working!');
        }
        
        // Backup event listeners for critical functions
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Backup event listeners loading...');
            
            // Ensure FAB button works
            const fab = document.getElementById('fab');
            if (fab) {
                fab.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    console.log('FAB clicked');
                    if (typeof window.openAddTransactionModal === 'function') {
                        window.openAddTransactionModal();
                    }
                });
            }
            
            // Ensure navigation works
            document.querySelectorAll('.menu-item').forEach(function(item) {
                item.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    console.log('Menu item clicked:', this.dataset.screen);
                    
                    // Remove active class from all items
                    document.querySelectorAll('.menu-item').forEach(function(i) {
                        i.classList.remove('active');
                    });
                    
                    // Add active class to clicked item
                    this.classList.add('active');
                    
                    // Switch screen
                    const screenName = this.dataset.screen;
                    if (screenName) {
                        document.querySelectorAll('.screen').forEach(function(screen) {
                            screen.classList.remove('active');
                        });
                        
                        const targetScreen = document.getElementById(screenName + '-screen');
                        if (targetScreen) {
                            targetScreen.classList.add('active');
                        }
                        
                        // Update header title
                        const titles = {
                            transactions: 'Transactions',
                            analytics: 'Analytics', 
                            accounts: 'Accounts',
                            settings: 'Settings'
                        };
                        
                        const titleElement = document.getElementById('screen-title');
                        if (titleElement && titles[screenName]) {
                            titleElement.textContent = titles[screenName];
                        }
                        
                        // Show/hide FAB and month nav
                        const fab = document.getElementById('fab');
                        const monthNav = document.getElementById('month-nav');
                        
                        if (fab) {
                            fab.style.display = screenName === 'transactions' ? 'flex' : 'none';
                        }
                        
                        if (monthNav) {
                            monthNav.style.display = screenName === 'transactions' ? 'flex' : 'none';
                        }
                    }
                });
            });
            
            console.log('Backup event listeners loaded');
        });
    </script>
    <script src="app.js"></script>
</body>
</html>